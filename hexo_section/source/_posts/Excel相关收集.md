---
title: Excel相关收集
categories:
  - Windows
toc: false
date: 2018-09-27 19:38:41
tags:
---
摘要暂略。
<!-- more -->

#### 官网的几个有用的连接
[Excel 函数（按类别列出）](https://support.office.com/zh-cn/article/Excel-函数（按类别列出）-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb)。  
[Excel 函数（按字母顺序）](https://support.office.com/zh-cn/article/excel-函数（按字母顺序）-b3944572-255d-4efb-bb96-c6d90033e188)。  

#### Excel的几个快捷键
|快捷键         |名字         |备注     |备注2 |
|:------------:|:-----------:|:-------:|:---:|
|Alt+A+E       |分列         |数据->分列|略    |
|Ctrl+1        |设置单元格格式|略       |略    |
|Ctrl+Shfit+End|略           |略       |从当前单元格一直选定到表格的最后一个有效单元格|
|Ctrl+D        |向下填充      |D和Down |略     |
|Ctrl+Home     |             |         |移动到工作表的开头|
|Ctrl+End      |             |         |移动到工作表的(最后一行&最后一列)的单元格|
|Home          |             |         |当前行的行首|
|Home          |             |         |行首  |
|Ctrl+←        |行首         |         |确保某行的单元格之间没有空白单元格|
|Ctrl+→        |行尾         |         |确保某行的单元格之间没有空白单元格|
#### 向下填充
`开始`>`编辑`>`填充`>`向下填充(Ctrl+D)`。

#### 字符串转日期时间
例1：`A1`内容`2006-01-02 15:04:05.999999999`。我想把它转换成日期时间，则可以输入函数：  
`= DATE(MID(A1,1,4),MID(A1,6,2),MID(A1,9,2)) + TIME(MID(A1,12,2),MID(A1,15,2),MID(A1,18,2))`。  
例2：`A2`内容`20060102`。我想把它转换成日期，则可以输入函数：  
`=TEXT(A3,"0000-00-00") * 1`。  
例3：`A3`内容`030405999`。我想把它转换成时间，则可以输入函数：  
`=TEXT(A3,"00\:00\:00\.000") * 1`(我也不知道`*1`表征了什么)。  
(猜测"字符串*1"=>"数字"。因为这样运算之后，内容变成右对齐了)。
```
2006-01-02 15:04:05.999999999    <= A1单元格的内容
12345678901234567890123456789    <= A1的内容的序号
20060102                         <= A2单元格的内容
12345678                         <= A2的内容的序号
030405999                        <= A3单元格的内容
123456789                        <= A3的内容的序号
```

#### 两个日期时间相差多少秒
例如，`A1`内容`2006-01-02 15:04:05`，`A2`内容`2006-01-02 03:04:05`，我想计算`A1`和`A2`相差多少秒，则可以输入函数：  
`= (A1 - A2) * 24 * 60 * 60`。

#### 怎么用Excel画图
Excel的`行号`用数字表示，`列号`用(A~Z)和(AA~ZZ)等表示。  
选中第A列：鼠标左键点击列号A即可选中第A列的所有数据。  
选择第A列和第C列：按着Ctrl的同时，选中第A列和第C列。  
根据某列画图表：`用Excel打开某文件`>`选中一列或多列`>`插入`>`图表`>`所有图表`>`折线图`>`折线图`>`确定`。  
设置图表的横轴：`(右键)图表区`>`选择数据`>`水平(分类)轴标签`>`编辑`>`(左键)选中(要当做横轴的)某列`>`确定`。

#### 注意
如果我们任意选择的单元格，上下前后有空白单元格的话，那它只能定位到最接近空白单元格的一个单元格。所以我们在选择单元格时，一定要防止这种情况发生。

####
我在`M2`(第M列的第2行)写了一个公式，然后想填充整个M3~Mend的整个M列，则
①选中M2②Ctrl+Shift+End选中M列③Ctrl+D向下填充。

#### 设置单元格格式
[Review guidelines for customizing a number format](https://support.office.com/en-us/article/review-guidelines-for-customizing-a-number-format-c0a1d1fa-d3f4-4018-96b7-9c9354dd99f5?ui=en-US&rs=en-US&ad=US)。  
[查看有关自定义数字格式的准则](https://support.office.com/zh-cn/article/查看有关自定义数字格式的准则-c0a1d1fa-d3f4-4018-96b7-9c9354dd99f5)。  
可以搜索`Excel设置单元格格式`或`Excel设置单元格格式自定义`等查看相关内容。  
可以搜索`详解EXCEL单元格自定义格式`或`Excel单元格格式设置自定义格式详解(很全面、完整)`等。  
```
0: 数字占位符。会显示无效的零。如果单元格的内容大于占位符的数量，则显示实际数字；如果小于点位符的数量，则用0补足。
#: 数字占位符。不显示无效的零。小数点后数字如大于"#"的数量，则按"#"的位数四舍五入。
.: 数字占位符。在数字中显示小数点。
```
模拟“万位分隔符”：右键某列，设置单元格格式，数字，自定义，在类型中输入`####","####`。
数字模拟时间格式：`00":"00":"00`。  
猜测：可以用“双引号”包含字符串，然后连接各项。  

#### 从excel中提取超链接的地址
先`Alt+F11`再`Alt+I`再`Alt+M`，然后书写以下语句：
```VB
' VBA对象、属性和方法
' https://www.w3cschool.cn/excelvba/excelvba-object.html
' 在关键字上面按F1可查看帮助.
Sub 获取超链接的地址()
' Range("A1:D10") => 单元格区域 A1:D10 中进行循环
For Each cell In Range("C3:C143")
' 假设当前单元格是cell, 那么 cell.Offset(0, 1) 将会指向往下0行和往右1列的单元格.
If cell.Hyperlinks.Count > 0 Then
    cell.Offset(0, 1) = cell.Value
    cell.Offset(0, 2) = cell.Hyperlinks(1).Address
End If
Next
End Sub
```
